import{s as F,r as t,j as e,L as g,K as D,I as n,a5 as L,Q as A,S as E,a6 as $,a7 as O,a8 as R,W as U,a9 as B}from"./index-DnyENzFv.js";import{D as K,a as W,b as q,c as H,d as M}from"./dialog-C2hEiaiA.js";import{T as Q}from"./textarea-qx0JtSPu.js";import"./index-C-aOu7yy.js";function Y(){const{presetDialogOpen:o,closePresetDialog:f,editingPreset:r,presets:c,savePreset:I,deletePreset:k,openPresetDialog:P,togglePresetVisibility:S}=F(),[m,d]=t.useState(""),[w,x]=t.useState(""),[j,b]=t.useState(""),[i,N]=t.useState(!1),[h,l]=t.useState(""),[v,p]=t.useState(""),u=t.useRef(null);t.useEffect(()=>{if(o&&r){const s=c.find(a=>a.name===r);s&&(d(s.name),x(s.accounts.join(", ")))}else o&&(d(""),x(""));b(""),N(!1),l(""),p("")},[o,r,c]);const T=()=>{if(!m.trim())return;const s=w.split(",").map(a=>a.trim().replace(/^@/,"").toLowerCase()).filter(Boolean);s.length&&(I(m.trim(),s,r),f())},y=async()=>{const s=j.trim().replace(/^@/,"").toLowerCase();if(!(!s||i)){N(!0),p(""),l("Fetching following list..."),u.current=new AbortController;try{const a=await B(s,z=>l(z),u.current.signal);if(a.length===0){p("No accounts found. The user may have a private following list.");return}m.trim()||d(`${s}'s following`),x(a.join(", ")),l(`Imported ${a.length} accounts`)}catch(a){a.name==="AbortError"?l("Cancelled"):p(a.message)}finally{N(!1),u.current=null}}},C=()=>{var s;(s=u.current)==null||s.abort()};return e.jsx(K,{open:o,onOpenChange:s=>{s||(C(),f())},children:e.jsxs(W,{className:"preset-dialog sm:max-w-md w-full",children:[e.jsx("div",{className:"px-6 pt-6 pb-4",children:e.jsxs(q,{children:[e.jsx(H,{children:r?"Edit preset":"Manage presets"}),e.jsx(M,{children:"Create lists of accounts for quick scanning."})]})}),e.jsxs("div",{className:"px-6 pb-6 space-y-4",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"preset-import space-y-2",children:[e.jsx(g,{children:"Import from Twitter"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter a Twitter username to import the accounts they follow as a preset."}),e.jsx("div",{className:"rounded-md bg-amber-500/10 dark:bg-amber-500/10 border border-amber-500/30 dark:border-amber-500/20 px-3 py-2",children:e.jsxs("p",{className:"text-xs text-amber-900 dark:text-amber-200 leading-relaxed",children:[e.jsx("strong",{className:"font-medium",children:"Note:"})," Importing lists with thousands of accounts can consume credits rapidly when scanned. Consider creating smaller, focused presets to manage your credit usage effectively."]})}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(D,{value:j,onChange:s=>b(s.target.value),placeholder:"@ username",className:"flex-1 h-9",onKeyDown:s=>{s.key==="Enter"&&y()},disabled:i}),i?e.jsx(n,{variant:"outline",onClick:C,size:"sm",className:"h-9",children:"Cancel"}):e.jsxs(n,{onClick:y,size:"sm",disabled:!j.trim(),className:"h-9",children:[e.jsx(L,{className:"h-3.5 w-3.5 mr-1.5"}),"Import"]})]}),i&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(A,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{children:h})]}),v&&e.jsx("p",{className:"text-xs text-destructive",children:v}),!i&&!v&&h&&h.startsWith("Imported")&&e.jsx("p",{className:"text-xs text-signal-green",children:h})]}),e.jsx(E,{})]}),e.jsxs("div",{className:"preset-form space-y-2",children:[e.jsx(g,{children:"Preset name"}),e.jsx(D,{value:m,onChange:s=>d(s.target.value),placeholder:"E.g. Commodities"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Accounts (comma-separated)"}),e.jsx(Q,{value:w,onChange:s=>x(s.target.value),placeholder:"account1, account2, account3",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(n,{variant:"outline",onClick:f,children:"Cancel"}),e.jsx(n,{onClick:T,children:r?"Update preset":"Save preset"})]}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"my-4"}),e.jsxs("div",{className:"preset-list space-y-2",children:[e.jsx(g,{children:"Existing presets"}),c.map(s=>e.jsxs("div",{className:"preset-item flex items-center gap-2 p-2 rounded-md border text-sm",children:[e.jsx("span",{className:`flex-1 font-normal ${s.hidden?"text-muted-foreground":""}`,children:s.name}),e.jsx("span",{className:"text-muted-foreground",children:s.accounts.length}),e.jsx(n,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>S(s.name),children:s.hidden?e.jsx($,{className:"h-3 w-3 text-muted-foreground"}):e.jsx(O,{className:"h-3 w-3"})}),e.jsx(n,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>P(s.name),children:e.jsx(R,{className:"h-3 w-3"})}),e.jsx(n,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>{confirm(`Delete preset "${s.name}"?`)&&k(s.name)},children:e.jsx(U,{className:"h-3 w-3"})})]},s.name))]})]})]})]})})}export{Y as PresetDialog};
