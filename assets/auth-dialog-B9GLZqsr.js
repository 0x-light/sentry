import{t as K,r as i,j as e,L as d,K as m,I as u,Q as w,S as v}from"./index-DnyENzFv.js";import{D as I,a as A,b as B,c as F,d as M}from"./dialog-C2hEiaiA.js";import{T as R,a as U,b as N,d as b}from"./tabs-Dw59KN9_.js";import"./index-C-aOu7yy.js";function _({open:C,onOpenChange:j,defaultTab:S="login"}){const{signIn:k,signUp:D,signInWithGoogle:E,resetPassword:L}=K(),[P,T]=i.useState(S),[l,g]=i.useState(""),[r,h]=i.useState(""),[o,a]=i.useState(""),[t,n]=i.useState(!1),[c,y]=i.useState(""),x=async()=>{if(!l.trim()||!r.trim()){a("Please enter your email and password");return}a(""),n(!0);try{await k(l.trim(),r),j(!1),g(""),h("")}catch(s){a(s.message||"Login failed")}finally{n(!1)}},p=async()=>{if(!l.trim()||!r.trim()){a("Please enter your email and password");return}if(r.length<6){a("Password must be at least 6 characters");return}a(""),n(!0);try{await D(l.trim(),r),y("Check your email for a confirmation link!"),a("")}catch(s){a(s.message||"Sign up failed")}finally{n(!1)}},f=async()=>{a(""),n(!0);try{await E()}catch(s){a(s.message||"Google login failed"),n(!1)}},G=async()=>{if(!l.trim()){a("Please enter your email first");return}a(""),n(!0);try{await L(l.trim()),y("Password reset email sent!")}catch(s){a(s.message||"Failed to send reset email")}finally{n(!1)}};return e.jsx(I,{open:C,onOpenChange:j,children:e.jsxs(A,{className:"auth-dialog sm:max-w-md w-full",children:[e.jsx("div",{className:"px-6 pt-6 pb-4",children:e.jsxs(B,{children:[e.jsx(F,{children:"Welcome to Sentry"}),e.jsx(M,{children:"Sign in to sync your data, unlock scans, and manage your subscription."})]})}),e.jsx("div",{className:"px-6 pb-6",children:e.jsxs(R,{value:P,onValueChange:T,children:[e.jsxs(U,{className:"grid w-full grid-cols-2",children:[e.jsx(N,{value:"login",children:"Log in"}),e.jsx(N,{value:"signup",children:"Sign up"})]}),e.jsxs(b,{value:"login",className:"auth-login space-y-4 mt-4",children:[o&&e.jsx("p",{className:"text-sm text-destructive",children:o}),c&&e.jsx("p",{className:"text-sm text-signal-green",children:c}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Email"}),e.jsx(m,{type:"email",value:l,onChange:s=>g(s.target.value),onKeyDown:s=>{s.key==="Enter"&&x()},placeholder:"you@email.com",disabled:t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Password"}),e.jsx(m,{type:"password",value:r,onChange:s=>h(s.target.value),onKeyDown:s=>{s.key==="Enter"&&x()},placeholder:"••••••••",disabled:t})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(u,{className:"flex-1",onClick:x,disabled:t,children:t?e.jsx(w,{className:"h-4 w-4 animate-spin"}):"Log in"})}),e.jsx("button",{onClick:G,className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Forgot password?"}),e.jsx(v,{}),e.jsx(u,{variant:"outline",className:"w-full",onClick:f,disabled:t,children:"Continue with Google"})]}),e.jsxs(b,{value:"signup",className:"auth-signup space-y-4 mt-4",children:[o&&e.jsx("p",{className:"text-sm text-destructive",children:o}),c&&e.jsx("p",{className:"text-sm text-signal-green",children:c}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Email"}),e.jsx(m,{type:"email",value:l,onChange:s=>g(s.target.value),onKeyDown:s=>{s.key==="Enter"&&p()},placeholder:"you@email.com",disabled:t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Password"}),e.jsx(m,{type:"password",value:r,onChange:s=>h(s.target.value),onKeyDown:s=>{s.key==="Enter"&&p()},placeholder:"Min 6 characters",disabled:t})]}),e.jsx(u,{className:"w-full",onClick:p,disabled:t,children:t?e.jsx(w,{className:"h-4 w-4 animate-spin"}):"Create account"}),e.jsx(v,{}),e.jsx(u,{variant:"outline",className:"w-full",onClick:f,disabled:t,children:"Continue with Google"}),e.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:["By signing up, you agree to our"," ",e.jsx("a",{href:"/tos",target:"_blank",className:"underline hover:text-foreground transition-colors",children:"Terms of Service"}),"."]})]})]})})]})})}export{_ as AuthDialog};
